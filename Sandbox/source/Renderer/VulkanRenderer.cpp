#include "sandboxPCH.h"
#include "VulkanRenderer.h"
#include "VulkanDevice.h"

//---------------------------------------------------------------------------------------------------------------------
VulkanRenderer::VulkanRenderer()
{
	m_pRC = new RenderContext();
	m_pVulkanDevice = nullptr;
}

//---------------------------------------------------------------------------------------------------------------------
VulkanRenderer::~VulkanRenderer()
{
	SAFE_DELETE(m_pRC);
	SAFE_DELETE(m_pVulkanDevice);
}

//---------------------------------------------------------------------------------------------------------------------
void VulkanRenderer::Destroy()
{
	vkDestroySurfaceKHR(m_pRC->vkInst, m_pRC->vkSurface, nullptr);
	m_pVulkanDevice->Destroy();
}

//---------------------------------------------------------------------------------------------------------------------
bool VulkanRenderer::Initialize(GLFWwindow* pWindow, VkInstance instance)
{
	m_pRC->vkInst = instance;
	m_pRC->pWindow = pWindow;

	// Create surface
	VK_CHECK(glfwCreateWindowSurface(instance, pWindow, nullptr, &(m_pRC->vkSurface)));

	// Create Vulkan device...
	m_pVulkanDevice = new VulkanDevice(m_pRC);
	CHECK(m_pVulkanDevice->SetupDevice(m_pRC));
}

//---------------------------------------------------------------------------------------------------------------------
void VulkanRenderer::Update(float dt)
{

}

//---------------------------------------------------------------------------------------------------------------------
void VulkanRenderer::Render()
{

}

//---------------------------------------------------------------------------------------------------------------------
bool VulkanRenderer::CreateGraphicsPipeline(Helper::App::ePipeline pipeline)
{
	switch (pipeline)
	{
		case Helper::App::FORWARD:
		{
			// Read shader code & create modules
			VkShaderModule vsModule = Helper::Vulkan::CreateShaderModule(m_pRC->vkDevice, "Assets/Shaders/triangle.vert.spv");
			VkShaderModule fsModule = Helper::Vulkan::CreateShaderModule(m_pRC->vkDevice, "Assets/Shaders/triangle.frag.spv");



			break;
		}

		default:
			break;
	}
	return false;
}

//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------


//---------------------------------------------------------------------------------------------------------------------